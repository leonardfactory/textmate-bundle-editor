var twig 	= require('twig');
var fs		= require('fs');

module.exports = Lister = function(folder)
{
	var self = {};
	self.templates = {};
	
	self.build = function () 
	{
		self.folder = folder;
		
		self.templates.list = twig.twig({
		    id: "lists",
		    // for this example we'll block until the template is loaded
		    data: '<ul class="file-list">{% for item in items %}<li><a class="icon {{ item.ext[0] }}">{{ item.name }}</a></li>{% endfor %}</ul>'
		});
	}
	
	
	self.buildList = function()
	{
		var rendered_folder = [];
		self.folder.files.forEach(function(folder_item)
		{
			console.dir(folder_item);
			if(folder_item.dir) {
				rendered_folder.push({
					ext		: ['directory', ''],
					name 	: folder_item.name
				});
			}
			else {
				rendered_folder.push(folder_item);
			}
		});
		
		console.dir(rendered_folder);
		
		return self.templates.list.render({ items: rendered_folder });
	}
	
	self.build();
	return self;
}